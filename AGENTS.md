# AGENTS.md

## 基本原则
- 执行多次失败就停下来问，不要靠猜。

## 交流与代码风格
- 默认使用中文回复（除非我明确要求英文）。
- 仅在有明确事实依据时承认错误；不得随意承认错误。
- 统一使用中文注释，重点解释“为什么这样做/业务含义/风险点
- 优先写“意图注释”，而不是“语法注释”
- 类职责必须单一且清晰，每个类必须有 DocBlock，用一句话说明该类解决什么问题
- 函数职责清晰，每个函数必须有 DocBlock，说明职责、参数、返回值、异常/副作用(如果有才写)
- 关键业务逻辑必须解释设计原因
- 复杂条件必须拆成中间变量，并写注释
- 任何“规则/判断/映射/状态流转/常量”必须注释业务含义
- 如果有任何不直观的实现，请在代码中解释原因。
- 变量命名清晰优先表达业务、函数短小、结构直观
- 代码要易读可维护，不允许黑魔法式写法

## Git 提交流程（强制）
- 任何 `git commit`（创建 PR）之前，必须先停下来向我确认：
  - 本次改动摘要（做了什么/没做什么）
  - 影响范围（涉及哪些模块/接口/数据表）
  - 已做的校验与验收（跑了哪些检查/是否补了测试）
  - 可能风险与回滚点
- 未得到确认：不得执行提交相关操作。
- 默认提交范围：代理在当前任务中创建/修改的文件，无需逐个确认。
- 仅在以下情况需要额外确认：
  - 与当前任务无关或不确定归属的文件
  - 大文件/二进制文件

## Commit message 规范（强制）
- Git commit message 必须使用中文，且必须包含“标题 + 正文”两部分：
  - 标题（第一行）：一句话说明改动目的/结果（建议不超过 50 字）
  - 正文（必须）：用要点列出关键变更点与影响范围（建议 3~8 条）

## Git 推送远端
- git push 推送到远端之后查看 CI，命令: gh run list -L 5

## 数据库字段中文说明（强制）
- 新增/修改任何数据表字段时，必须补充字段的中文说明（字段 comment），并保持含义清晰、可维护。
- 表级也要有中文注释（table comment），说明该表用途。
- 若字段是枚举/状态值：必须在注释或对应文档里写明取值含义。
- Laravel migrations：列字段必须使用 `->comment('中文说明')`；建表时设置表注释（table comment）。
