# 数据库注释清单对照

> 说明：本清单基于迁移里的注释定义整理，便于核对落库结果。
> 来源迁移：
> - `backend/database/migrations/2026_01_20_000006_update_forums_threads_posts_comments.php`
> - `backend/database/migrations/2026_01_20_000007_update_system_table_comments.php`

## forums（NGA 版块配置与抓取策略（支持多 fid 扩展））

| 字段 | 中文说明 |
| --- | --- |
| id | 主键 |
| source_forum_id | NGA fid |
| forum_name | 版块名称（可选） |
| list_url | 版块列表 URL（排查用） |
| crawl_page_limit | 单次抓取页上限 |
| request_rate_limit_per_sec | 抓取限速（每秒请求数上限） |
| created_at | 创建时间 |
| updated_at | 更新时间 |

## threads（NGA 主题（列表页实体 + 增量判定 + 抓取游标 + 截断信息））

| 字段 | 中文说明 |
| --- | --- |
| id | 主键 |
| forum_id | 所属版块（forums.id） |
| source_thread_id | NGA tid |
| title | 标题原文 |
| title_prefix_text | 标题前缀文本（如 水） |
| author_name | 楼主显示名 |
| author_source_user_id | 楼主 uid（可选） |
| thread_created_at | 发帖时间（列表口径） |
| last_reply_at | 最后回复时间（变化判定） |
| reply_count_display | 列表页显示回复数 |
| view_count_display | 列表页显示浏览数 |
| is_pinned | 是否置顶 |
| is_digest | 是否精华 |
| first_seen_on_list_page_number | 首次发现所在列表页码 |
| last_seen_on_list_page_number | 最近扫描到所在列表页码 |
| is_truncated_by_page_limit | 当前是否仍未抓全（受单次页上限影响） |
| truncated_at_page_number | 本次抓取到的最后页码（绝对页码，用于排查/提示） |
| last_crawled_at | 最近成功抓取时间 |
| last_detected_change_at | 最近一次检测到变化时间 |
| crawl_page_total_last_seen | 最近一次探测到的主题总页数（分段补齐/跳过判定） |
| crawl_backfill_next_page_number | 分段补齐下次起始页码（NULL 表示已补齐） |
| is_skipped_by_page_total_limit | 是否因主题总页数>1000页跳过详情 |
| skipped_by_page_total_limit_at | 首次触发>1000页跳过时间 |
| crawl_cursor_max_floor_number | 已抓到最大楼层号 |
| crawl_cursor_max_source_post_id | 已抓到最大 pid |
| title_last_changed_at | 标题最后变化时间 |
| created_at | 创建时间 |
| updated_at | 更新时间 |

## posts（NGA 楼层（当前版本内容，支持增量追加与删除/折叠标记））

| 字段 | 中文说明 |
| --- | --- |
| id | 主键 |
| thread_id | 所属主题（threads.id） |
| source_post_id | NGA pid |
| floor_number | 楼层号（1 为首帖） |
| author_name | 楼层作者显示名 |
| author_source_user_id | 楼层作者 uid（可选） |
| post_created_at | 发帖时间 |
| content_html | 楼层内容（当前版本 HTML） |
| content_fingerprint_sha256 | 内容指纹（SHA256） |
| is_deleted_by_source | 是否被源站删除 |
| is_folded_by_source | 是否被源站折叠 |
| content_last_changed_at | 内容最后变化时间 |
| created_at | 创建时间 |
| updated_at | 更新时间 |

## users（系统用户表）

| 字段 | 中文说明 |
| --- | --- |
| id | 主键 |
| name | 用户名 |
| email | 邮箱 |
| email_verified_at | 邮箱验证时间 |
| password | 密码哈希 |
| remember_token | 记住我令牌 |
| created_at | 创建时间 |
| updated_at | 更新时间 |

## password_reset_tokens（密码重置令牌）

| 字段 | 中文说明 |
| --- | --- |
| email | 用户邮箱 |
| token | 重置令牌 |
| created_at | 创建时间 |

## sessions（会话表）

| 字段 | 中文说明 |
| --- | --- |
| id | 会话 ID |
| user_id | 用户 ID |
| ip_address | 客户端 IP |
| user_agent | 客户端 UA |
| payload | 会话内容 |
| last_activity | 最近活动时间（时间戳） |

## cache（缓存表）

| 字段 | 中文说明 |
| --- | --- |
| key | 缓存键 |
| value | 缓存值 |
| expiration | 过期时间（时间戳） |

## cache_locks（缓存锁表）

| 字段 | 中文说明 |
| --- | --- |
| key | 锁键 |
| owner | 锁持有者 |
| expiration | 过期时间（时间戳） |

## jobs（队列任务）

| 字段 | 中文说明 |
| --- | --- |
| id | 主键 |
| queue | 队列名称 |
| payload | 任务负载 |
| attempts | 已尝试次数 |
| reserved_at | 预留时间（时间戳） |
| available_at | 可执行时间（时间戳） |
| created_at | 创建时间（时间戳） |

## job_batches（队列批次）

| 字段 | 中文说明 |
| --- | --- |
| id | 批次 ID |
| name | 批次名称 |
| total_jobs | 总任务数 |
| pending_jobs | 待处理任务数 |
| failed_jobs | 失败任务数 |
| failed_job_ids | 失败任务 ID 列表 |
| options | 批次选项 |
| cancelled_at | 取消时间（时间戳） |
| created_at | 创建时间（时间戳） |
| finished_at | 完成时间（时间戳） |

## failed_jobs（失败任务）

| 字段 | 中文说明 |
| --- | --- |
| id | 主键 |
| uuid | 唯一 ID |
| connection | 连接名称 |
| queue | 队列名称 |
| payload | 任务负载 |
| exception | 异常信息 |
| failed_at | 失败时间 |
